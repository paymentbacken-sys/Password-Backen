<!DOCTYPE html>
<html>
<head>
  <title>Email Reveal</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #333; }
    .class-section { margin-bottom: 20px; }
    .class-section h3 { margin-bottom: 10px; color: #005f99; }
    .sub-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
    button { padding: 10px 15px; cursor: pointer; border-radius: 5px; border: none; background: #009688; color: #fff; transition: 0.3s; }
    button:hover { background: #00796b; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    #email { margin-top: 20px; font-weight: bold; color: green; }
  </style>
</head>
<body>

<h2>Email Access</h2>

<div id="buttons-container"></div>

<p id="email"></p>

<script>
// Define classes and subjects
const classes = [
  {
    name: "Class 9",
    subjects: [
      { id: "class9_science_practice", label: "Science – Practice Test" },
      { id: "class9_science_study", label: "Science – Study Material" }
    ]
  },
  {
    name: "Class 10",
    subjects: [
      { id: "class10_science_practice", label: "Science – Practice Test" },
      { id: "class10_science_study", label: "Science – Study Material" }
    ]
  }
];

// Container
const container = document.getElementById("buttons-container");

// Create buttons
classes.forEach(c => {
  const section = document.createElement("div");
  section.className = "class-section";

  const title = document.createElement("h3");
  title.innerText = c.name;
  section.appendChild(title);

  const subContainer = document.createElement("div");
  subContainer.className = "sub-buttons";

  c.subjects.forEach(s => {
    const btn = document.createElement("button");
    btn.innerText = s.label;
    btn.onclick = () => getEmail(s.id);
    subContainer.appendChild(btn);
  });

  section.appendChild(subContainer);
  container.appendChild(section);
});

function getEmail(category) {
  fetch(`/email?category=${category}`)
    .then(res => res.json())
    .then(data => {
      document.getElementById("email").innerText = data.email || data.message;
      // Disable all buttons after first click
      document.querySelectorAll("button").forEach(b => b.disabled = true);
    })
    .catch(() => {
      document.getElementById("email").innerText = "Server error";
    });
}
</script>

</body>
</html>
